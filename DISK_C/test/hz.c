#include <graphics.h>
#include<conio.h>
#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include"hz.h"

void puthz(int x, int y,char *s,int flag,int part,int color)
{
	FILE *hzk_p=NULL;                                       //ï¿½ï¿½ï¿½åººï¿½Ö¿ï¿½ï¿½Ä¼ï¿½Ö¸ï¿½ï¿½
	unsigned char quma,weima;                 //ï¿½ï¿½ï¿½åººï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿?
	unsigned long offset;                          //ï¿½ï¿½ï¿½åººï¿½ï¿½ï¿½ï¿½ï¿½Ö¿ï¿½ï¿½Ðµï¿½Æ«ï¿½ï¿½ï¿½ï¿½
	unsigned char mask[] = {0x80,0x40,0x20,0x10,0x08,0x04,0x02,0x01};  //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½é£¬ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¾ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½Ðµï¿½ï¿½ï¿½ï¿½ï¿½
	int i,j,pos;


	switch(flag)    //ï¿½ï¿½Í¬ï¿½ï¿½flagï¿½ï¿½Ó¦ï¿½ï¿½Í¬ï¿½Äºï¿½ï¿½Ö¿â£¬Êµï¿½ï¿½ï¿½Ëºï¿½ï¿½ÖµÄ´ï¿½Ð¡ï¿½É¸ï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½Ä±ï¿½
	{
		case 16 :
				  {
					 char mat[32];   //16*16ï¿½Äºï¿½ï¿½ï¿½ï¿½ï¿½Òª32ï¿½ï¿½ï¿½Ö½Úµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½æ´¢
					int y0=y;
					int x0=x;
					 hzk_p = fopen("HZK\\HZ16","rb");            //Ê¹ï¿½ï¿½ï¿½ï¿½ï¿½Â·ï¿½ï¿?
					 if(hzk_p==NULL)
					 {
						settextjustify(LEFT_TEXT,TOP_TEXT);          //ï¿½ó²¿¶ï¿½ï¿½ë£¬ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
						settextstyle(GOTHIC_FONT,HORIZ_DIR,1);					//ï¿½ï¿½ï¿½ï¿½Ê»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ë®Æ½ï¿½ï¿½ï¿½ï¿½ï¿?24*24ï¿½ï¿½ï¿½ï¿½
						outtextxy(10,10,"Can't open hzk16 file!Press any key to quit...");
						 getch();
						 exit(1);

					}
					while(*s!=NULL)
					{
						while (x<640-flag && (*s!=NULL))
						{
							y=y0;
							quma=s[0]-0xa0;                      //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿?
							weima=s[1]-0xa0;                     //ï¿½ï¿½ï¿½Î»ï¿½ï¿?
							offset=(94*(quma-1)+(weima-1))*32L;   //ï¿½ï¿½ï¿½Ò?ï¿½ï¿½Ê¾ï¿½Äºï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö¿ï¿½ï¿½Ä¼ï¿½ï¿½Ðµï¿½Æ«ï¿½ï¿½
							fseek(hzk_p,offset,SEEK_SET);         //ï¿½Ø¶ï¿½Î»ï¿½Ä¼ï¿½Ö¸ï¿½ï¿½
							fread (mat,32,1,hzk_p);            //ï¿½ï¿½ï¿½ï¿½ï¿½Ãºï¿½ï¿½ÖµÄ¾ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿?,1ÎªÒªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿?

							for(i=0;i<16;i++)
							{
								pos=2*i;       //16*16ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ã¿Ò»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö½ï¿½
								for(j=0;j<16;j++)    //Ò»ï¿½ï¿½Ò»ï¿½Ðµï¿½É¨ï¿½è£¬ï¿½ï¿½Î»ï¿½ï¿½Îªï¿½ï¿½1ï¿½Äµï¿½ï¿½ï¿½Ê¾ï¿½ï¿½ï¿½ï¿½
								{
									if((mask[j%8]&mat[pos+j/8])!=NULL)   //j%8Ö»ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½8Ö®ï¿½ï¿½Ñ­ï¿½ï¿½ï¿½ï¿½j/8ï¿½ï¿½0ï¿½ï¿½1Ö®ï¿½ï¿½Ñ­ï¿½ï¿½
									{
										putpixel(x+j,y,color);

									}

								}
								y++;


							}
							/*====================================================
								ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ò»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¾ï¿½ï¿½
							====================================================*/
							x+=part;        //ï¿½ï¿½x Ò»ï¿½ï¿½Æ«ï¿½ï¿½ï¿½ï¿½part
							s+=2;           //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Åµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ë£¬2ï¿½ï¿½ï¿½Ö½Ú£ï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½ï¿½2

						}
						x=x0;y0+=flag+10; //Ò»ï¿½Ðºï¿½ï¿½ï¿½ï¿½ï¿½Ê¾ï¿½ï¿½ï¿?,ï¿½ï¿½ï¿½Â´ï¿½ï¿½ï¿½à¿?Ê¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö£ï¿½ï¿½ï¿½yÒ»ï¿½ï¿½Æ«ï¿½ï¿½ï¿½ï¿½
					}

					break;

				 }


		case 24 :
				  {
					char mat[72];   //24*24ï¿½ï¿½ï¿½ï¿½Òª72ï¿½ï¿½ï¿½Ö½ï¿½ï¿½ï¿½ï¿½æ´¢
					 int y0=y;
					 int x0=x;
					hzk_p = fopen("HZK\\Hzk24k","rb");
					if (hzk_p==NULL)
					{
						settextjustify(LEFT_TEXT,TOP_TEXT);          //ï¿½ó²¿¶ï¿½ï¿½ë£¬ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
						settextstyle(GOTHIC_FONT,HORIZ_DIR,3);					//ï¿½ï¿½ï¿½ï¿½Ê»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ë®Æ½ï¿½ï¿½ï¿½ï¿½ï¿?24*24ï¿½ï¿½ï¿½ï¿½
						outtextxy(10,10,"Can't open hzk24 file!Press any key to quit...");
						getch();
						exit(1);

					}
					while(*s!=NULL)
					{
						while(x<640-flag && (*s!=NULL))
						{
							y=y0;
							quma=s[0]-0xa0;                      //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿?
							weima=s[1]-0xa0;                     //ï¿½ï¿½ï¿½Î»ï¿½ï¿?
							offset=(94*(quma-1)+(weima-1))*72L;
							fseek(hzk_p,offset,SEEK_SET);
							fread (mat,72,1,hzk_p);
							for (i=0;i<24;i++)
							{
								pos=3*i;   //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ã¿Ò»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö½ï¿½
								for (j=0;j<24;j++)   // Ã¿Ò»ï¿½ï¿½ï¿½ï¿½24Î»
								{
									if ((mask[j%8]&mat[pos+j/8])!=NULL)
										putpixel(x+j,y,color);

								}
								y++;

							}
							x+=part;
							s+=2;
						}
						x=x0;y0+=flag+10;
					}
						break;
				}

		case 32 :
				  {
					 char mat[128];   //32*32ï¿½Äºï¿½ï¿½ï¿½ï¿½ï¿½Òª128ï¿½ï¿½ï¿½Ö½Úµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½æ´¢
					int y0=y;
					int x0=x;
					 hzk_p = fopen("HZK\\HZK32S","rb");
					 if(hzk_p==NULL)
					 {
						settextjustify(LEFT_TEXT,TOP_TEXT);          //ï¿½ó²¿¶ï¿½ï¿½ë£¬ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
						settextstyle(GOTHIC_FONT,HORIZ_DIR,3);					//ï¿½ï¿½ï¿½ï¿½Ê»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ë®Æ½ï¿½ï¿½ï¿½ï¿½ï¿?24*24ï¿½ï¿½ï¿½ï¿½						
						outtextxy(10,10,"Can't open hzk32 file!Press any key to quit...");
						 getch();
						 exit(1);

					}
					while(*s!=NULL)
					{
						while (x<640-flag && (*s!=NULL))
						{
							y=y0;
							quma=s[0]-0xa0;                      //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿?
							weima=s[1]-0xa0;                     //ï¿½ï¿½ï¿½Î»ï¿½ï¿?
							offset=(94*(quma-1)+(weima-1))*128L;
							fseek(hzk_p,offset,SEEK_SET);
							fread (mat,128,1,hzk_p);
							for(i=0;i<32;i++)
							{
								pos=4*i;       //32*32ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ã¿Ò»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö½ï¿½
								for(j=0;j<32;j++)
								{
									if((mask[j%8]&mat[pos+j/8])!=NULL)
									{
										putpixel(x+j,y,color);

									}

								}
								y++;


							}
								//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ò»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¾ï¿½ï¿½
							x+=part;    //ï¿½ï¿½x Ò»ï¿½ï¿½Æ«ï¿½ï¿½ï¿½ï¿½part
							s+=2;          //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Åµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ë£¬2ï¿½ï¿½ï¿½Ö½Ú£ï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½ï¿½2

						}
						x=x0;y0+=flag+10;   //Ò»ï¿½Ðºï¿½ï¿½ï¿½ï¿½ï¿½Ê¾ï¿½ï¿½ó£?¸ï¿½yÒ»ï¿½ï¿½Æ«ï¿½ï¿½ï¿½ï¿½
					}
						break;

				 }


		case 48:
				  {
					char mat[288];   //48*48ï¿½Äºï¿½ï¿½ï¿½ï¿½ï¿½Òª288ï¿½ï¿½ï¿½Ö½Úµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½æ´¢
					int y0=y;
					int x0=x;
					 hzk_p = fopen("HZK\\Hzk48k","rb");
					 if(hzk_p==NULL)
					 {
						settextjustify(LEFT_TEXT,TOP_TEXT);          //ï¿½ó²¿¶ï¿½ï¿½ë£¬ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
						settextstyle(GOTHIC_FONT,HORIZ_DIR,3);					//ï¿½ï¿½ï¿½ï¿½Ê»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ë®Æ½ï¿½ï¿½ï¿½ï¿½ï¿?24*24ï¿½ï¿½ï¿½ï¿½
						outtextxy(10,10,"Can't open hzk48 file!Press any key to quit...");
						 getch();
						 exit(1);

					}
					while(*s!=NULL)
					{
						while (x<640-flag && (*s!=NULL))
						{
							y=y0;
							quma=s[0]-0xa0;                      //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿?
							weima=s[1]-0xa0;                     //ï¿½ï¿½ï¿½Î»ï¿½ï¿?
							offset=(94*(quma-1)+(weima-1))*288L;   //ï¿½ï¿½ï¿½Ò?ï¿½ï¿½Ê¾ï¿½Äºï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö¿ï¿½ï¿½Ä¼ï¿½ï¿½Ðµï¿½Æ«ï¿½ï¿½
							fseek(hzk_p,offset,SEEK_SET);         //ï¿½Ø¶ï¿½Î»ï¿½Ä¼ï¿½Ö¸ï¿½ï¿½
							fread (mat,288,1,hzk_p);            //ï¿½ï¿½ï¿½ï¿½ï¿½Ãºï¿½ï¿½ÖµÄ¾ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿?,1ÎªÒªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿?

							for(i=0;i<48;i++)
							{
								pos=6*i;
								for(j=0;j<48;j++)    //Ò»ï¿½ï¿½Ò»ï¿½Ðµï¿½É¨ï¿½è£¬ï¿½ï¿½Î»ï¿½ï¿½Îªï¿½ï¿½1ï¿½Äµï¿½ï¿½ï¿½Ê¾ï¿½ï¿½ï¿½ï¿½
								{
									if((mask[j%8]&mat[pos+j/8])!=NULL)   //j%8Ö»ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½8Ö®ï¿½ï¿½Ñ­ï¿½ï¿½ï¿½ï¿½j/8ï¿½ï¿½0ï¿½ï¿½1Ö®ï¿½ï¿½Ñ­ï¿½ï¿½
									{
										putpixel(x+j,y,color);

									}

								}
								y++;
							}
								//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ò»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¾ï¿½ï¿½
							x+=part;    //ï¿½ï¿½x Ò»ï¿½ï¿½Æ«ï¿½ï¿½ï¿½ï¿½part
							s+=2;          //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Åµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ë£¬2ï¿½ï¿½ï¿½Ö½Ú£ï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½ï¿½2

						}
						x=x0;y0+=flag+10;   //Ò»ï¿½Ðºï¿½ï¿½ï¿½ï¿½ï¿½Ê¾ï¿½ï¿½ó£?¸ï¿½yÒ»ï¿½ï¿½Æ«ï¿½ï¿½ï¿½ï¿½
					}
						break;

				}

		default:
				  break;

	}

	fclose(hzk_p);
}

void put_all(int x, int y, char* s, int len, int color)//x,yè¡¨ç¤ºåæ ‡ï¼?*sè¡¨ç¤ºè¦è¾“å…¥å­—ç¬¦ä¸²ï¼Œlenè¡¨ç¤ºä¸€è¡Œçš„å­—çš„ä¸?æ•?,colorè¡¨ç¤ºé¢œè‰²
{
	char c[2];//è‹±æ–‡
	char z[3];//ä¸?æ–?
	int i = 0;
	int j=0;
	int n = 0;//è¡Œæ•°
	int m = 0;//å­—ç?¦é•¿åº?
	int n1=0;
	settextstyle(1, 0, 1);
	setcolor(color);
	m = strlen(s);
	for (i = 0; i < m; i++)
	{
		if (s[i] >= 32 && s[i] <= 126)
		{
			c[0] = s[i];
			c[1] = '\0';
			j=n%len;
			outtextxy(x + 15 * j+6, y + 9 + 20 * n1,c);
			n++;
		}
		else
		{
			z[0] = s[i];
			z[1] = s[i + 1];
			z[2] = '\0';
			j=n%len;
			puthz(x + 1 + 16 * j, y + 4 + 20 * n1, z, 16, 16, color);
			i = i + 1;
			n++;
		}
		if (n % len == 0)
		{
			n1++;
			n=0;
		}
	}
}

